import pandas as pd
import numpy as np
import streamlit as st
from tensorflow.keras.models import load_model
from sklearn.preprocessing import StandardScaler

# Load the trained model
model = load_model('my_model.h5')

# Load the scaler
scaler = StandardScaler()  # You need to save your scaler in the training script and load it here.

st.title('Malware Detection Using Permission Requirements (Team 9 Submission)')

# Load permissions from permissions.csv
permissions = pd.read_csv('Permissions.csv').columns.tolist()

# User selects permissions
selected_permissions = st.multiselect('Select permissions', permissions)

# Add a button for making predictions
if st.button('Predict'):
    if selected_permissions:
        # Create a DataFrame with 1 for selected permissions and 0 for the rest
        input_data = pd.DataFrame([[(1 if permission in selected_permissions else 0) for permission in permissions]], columns=permissions)
        print(input_data)
        # Normalize the input data
        inputs_normalized = input_data

        # Make prediction
        prediction = model.predict(inputs_normalized)

        # Show prediction
        st.write('Prediction value:', prediction[0])
        if prediction[0] > 0.5:
            st.write('This app is likely malicious.')
        else:
            st.write('This app is likely safe.')